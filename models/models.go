package models

import (
	"time"

	"gorm.io/gorm"
)

// LatestSchemaVersion manages the Schema version used in the latest go-exploitdb.
const LatestSchemaVersion = 2

// FetchMeta has meta information about fetched exploit
type FetchMeta struct {
	gorm.Model      `json:"-"`
	ExploitRevision string
	SchemaVersion   uint
	LastFetchedDate time.Time
}

// OutDated checks whether last fetched feed is out dated
func (f FetchMeta) OutDated() bool {
	return f.SchemaVersion != LatestSchemaVersion
}
